---
description: API usage rules (backend controllers + frontend API calls).
globs: ["**/controller/**", "frontend/src/services/**", "frontend/src/**/api*.ts", "frontend/src/**/use*.ts"]
alwaysApply: false
---

# API Rules

- Base path: `/api`. Frontend uses `VITE_API_BASE_URL` (default `http://localhost:8080/api`) and the proxy for local dev.
- Auth: `Authorization: Bearer <token>` on protected calls; backend derives hotelId from JWT, never from client payload.
- Error handling: return proper HTTP codes (400 validation, 401 auth, 404 not found, 409 conflicts like bike already rented/OOO). Frontend surfaces clear messages; handle 401 by clearing token + redirect to `/login`.
- DTOs: define request/response DTOs; no entity leakage; include only needed fields.
- Idempotency/consistency: multi-step operations (rental creation, returns) must be transactional server-side.
- Validation: server validates bike availability, OOO status, duplicates, required fields; frontend pre-validates forms for UX.
- Sorting/filtering: keep list endpoints scoped by hotel; allow status/search filters where relevant.
